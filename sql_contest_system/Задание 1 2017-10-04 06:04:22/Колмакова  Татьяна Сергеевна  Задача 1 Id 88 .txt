select distinct customer_rk,
(
	case 
		when middle_nm like ('%НА') then 'F'
        when middle_nm like ('%ИЧ') then 'M'
        else null
	end
) as gender
 from srcdt.cd_customers
 where year(valid_to_dttm) = '5999';