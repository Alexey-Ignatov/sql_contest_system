select
	customer_rk,
	case 
		when middle_nm is null then null
		when right(middle_nm, 1) = "А" then 'F'
                when right(middle_nm, 1) = "Ч" then 'M'
		else null
	end as gender
from
	cd_customers
where year(valid_to_dttm) = 5999