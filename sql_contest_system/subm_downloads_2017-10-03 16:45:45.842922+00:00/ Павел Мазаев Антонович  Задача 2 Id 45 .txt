select birth_year, count(1) from (
	select customer_rk, year(birth_dt) as birth_year from srcdt.cd_customers
	where customer_rk in
		(
			select customer_rk from (
				select distinct customer_rk, monthly_income_amt from srcdt.cd_customers
				where monthly_income_amt in (50000, 60000)
			) counting_good_entries
			group by customer_rk
			having count(1) = 2
		)
	and year(valid_to_dttm) = 5999
) getting_good_customers
group by birth_year;