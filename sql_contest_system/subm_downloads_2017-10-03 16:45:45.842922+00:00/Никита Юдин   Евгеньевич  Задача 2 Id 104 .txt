select tmp_table.birth_year as BIRTH_YEAR, count(tmp_table.customer_rk) as CLIENTS_COUNT
from(select customer_rk,
    sum(case
            when year(valid_to_dttm) = 5999 then year(birth_dt)
            else 0
        end) as birth_year,
    sum(case
            when monthly_income_amt = 50000 then 1
            else 0
        end) as sum_5,
    sum(case
            when monthly_income_amt = 60000 then 1
            else 0
        end) as sum_6
    from srcdt.cd_customers
    group by customer_rk) as tmp_table
where (tmp_table.sum_5 > 0) and (tmp_table.sum_6 > 0) and (tmp_table.birth_year > 0)
group by tmp_table.birth_year;